<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ConGun</title>
<meta name="description" content="Heavy Machinery Rentals">
<meta name="author" content="Congun">
<link rel="stylesheet"	href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500">
<link rel="stylesheet" href="../css/bootstrap.min.css">
<link rel="stylesheet" href="../font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../css/congun.css">
<link rel="stylesheet" href="../css/machines.css">
</head>
<body>
	<div class="header">
		<div class="container">
			<div class="row">
				<div class="col-md-12 navigation">
					<nav class="navbar navbar-defaut navbar-top" role="navigation">
						<div class="navbar-header">
							<button type="button" class="navbar-toggle"
								data-toggle="collapse" data-target="#navbar-collapse">
								<span class="sr-only">Toggle navigation</span> <span
									class="icon-bar"></span> <span class="icon-bar"></span> <span
									class="icon-bar"></span>
							</button>
							<a class="navbar-brand" href="index.html"> <img id="nav-logo"
								src="..\images\logo_new.png" height="75px" width="200px" />
							</a>
						</div>
						<div class="collapse navbar-collapse" id="navbar-collapse">
							<ul class="nav navbar-nav navbar-right" id="navigation-right">
								<li><a href="index.html"><span>Home</span></a></li>
								<li><a href="contact.html"><span>Contact Us</span></a></li>
								<li class="avatar-dropdown">
								<div class="dropdown">
								  <a class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
									<div id="profile-avatar"></div>
									<!-- <img src="http://placehold.it/50x50" alt="..." class="img-circle"> -->
									<span class="caret"></span>
								  </a>
								  <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1">
								  <li><a href="supplier-profile.html" ><span id="user">User</span></a></li>
								  	<li role="separator" class="divider"></li>
									<li><a href="supplier-profile.html"><span>Profile</span></a></li>
									<li><a href="supplier-dashboard.html"><span>Rental board</span></a></li>
									<li><a href="used-equipment.html"><span>Used equipment</span></a></li>
									<li role="separator" class="divider"></li>
									<li><a href="#" class="logout"><span>logout</a></span></li>
								  </ul>
								</div>
								</li>
							</ul>
						</div>
					</nav>
				</div>
			</div>
		</div>
	</div>

	<div class="content-main">
		<div class="container-fluid">
			<div class="row sub-nav-bar">
				<div class="col-md-6">
					<ul class="sub-menu">
						<li><a  href="supplier-profile.html">Profile</a></li>
						<li><a href="supplier-dashboard.html">Rental board</a></li>
						<li><a href="used-equipment.html">Used equipment</a></li>
					</ul>
				</div>
				<div class="col-md-6">
					<!-- <div class="search-bar-2">
						<form>
							<div class="input-group">
								<input type="text" id="search-input" class="form-control"
									placeholder="Search for..."> <span
									class="input-group-btn">
									<button class="btn btn-default" type="button" id="search-btn">
										<i class="fa fa-search"></i>
									</button>
								</span>
							</div>
						</form>
					</div> -->
				</div>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col-sm-3 col-md-2 sidebar">
					<ul class="nav nav-sidebar">
						<li class="active"><a href="#" id="view-machines">View Machine<span
								class="sr-only">(current)</span></a></li>
						<li><a href="#" id="add-machines">Add Machine</a></li>
					</ul>
				</div>
				<div class=" col-sm-9 col-md-10 sidebar-content">
					<ul class="nav-sidebar-content">
						<li>
							<div class="media">
								<div class="media-left">
									<a href="#">
								  		<img class="media-object" src="http://placehold.it/100x100" alt="...">
									</a>
								</div>
							 	<div class="media-body">
							  		<div class="block-top"><h4>Excavator</h4><div class="buttons"><a id="edit" role="button" data-toggle="modal" href="#edit-equipment"><i class="fa fa-edit"></i></a><a id="delete" role="button" data-toggle="modal" href="#delete-equipment"><i class="fa  fa-trash-o"></i></a></div><div class="clear-fix"></div></div>
							  		<p class="posted-date">Added on : 1 week ago</p>
							  		<p>Quantity : 1  |  Capacity : 20TON  |   Manufacturer : JCB  |   YOM : 2014 </p>
						  		</div>
							</div><!-- end of media -->
						</li>
						<li>
							<div class="media">
								<div class="media-left">
									<a href="#">
								  		<img class="media-object" src="http://placehold.it/100x100" alt="...">
									</a>
								</div>
							 	<div class="media-body">
							  		<div class="block-top"><h4>Excavator</h4><div class="buttons"><a id="edit" role="button" data-toggle="modal" href="#edit-equipment"><i class="fa fa-edit"></i></a><a id="delete" role="button" data-toggle="modal" href="#delete-equipment"><i class="fa  fa-trash-o"></i></a></div><div class="clear-fix"></div></div>
							  		<p class="posted-date">Added on : 1 week ago</p>
							  		<p>Quantity : 1 Capacity : 20TON Manufacturer : JCB YOM : 2014 </p>
						  		</div>
							</div><!-- end of media -->
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	<div class="sub-footer">
    <div class="container-fluid">
 			<div class="row">
 				<div class="col-md-4"><p class="first"><img src="../images/logo_new.png" /><br>CONGUN provides one stop online- solution for all construction equipment needs of construction Contractors, at their desired location, in specified time and at a low price.</p></div>
                <div class="col-md-4"><div class="middle"><h3>Quick Links</h3><ul>
              <li><span class="fa fa-angle-right"></span><a href="faq.html">FAQ</a></li>
							<li><span class="fa fa-angle-right"></span><a href="contact.html">Contact Us</a></li>
							<li><span class="fa fa-angle-right"></span><a href="terms.html">Terms and Conditions</a></li>
                    </ul></div></div>
                <div class="col-md-4">
                    
                    <div class="address-content last">
                        <h3> Address</h3>
                        <ul class="info">
                            <li><span class="fa fa-map-marker"></span> &ensp; 3rd floor T hub Gachibowli,IIIT Campus, Hyderabad, Telangana 500032</li>
                                <li><span class="fa fa-phone"></span> &ensp; +91-9989933636</li>
                                <li><span class="fa fa-envelope"></span> &ensp; <a href="mailto:info@congun.com">info@congun.com</a></li>
                        </ul>
                        <div class="social">
                           <a class="img-circle fa fa-facebook-f" href="https://www.facebook.com/Congun.india/" target="_blank"></a>
                           <a class="img-circle fa fa-twitter" href="https://twitter.com/Congunltd" target="_blank"></a>
                           <a class="img-circle fa fa-google-plus" href="https://plus.google.com/u/0/106690083354786500962" target="_blank"></a>
                           <a class="img-circle fa fa-linkedin" href="https://www.linkedin.com/company/congun-private-limited?trk=top_nav_home" target="_blank"></a>
                        </div>
                    </div>
                </div>
 			</div>
 		</div>
    </div>
 		
 		<!-- starting the js here -->
 		<script src="../js/jquery.min.js"></script>
		<script src="../js/bootstrap.min.js"></script>
		<script src="../js/appProperties.js"></script>
 		
 		
 		<!-- ********************* This is for the login model *********************************** -->
					<div class="modal fade" id="edit-equipment" role="dialog"
						aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content login-modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true">Ã—</button>
									<h4 class="modal-title" id="myModalLabel">Edit Equipment</h4>
								</div>
								<div class="modal-body">
								
									<form class="form-horizontal" role="form" id="equipment-form">
										
										<div class="form-group">
					
										<label for="selectCategory" class="sr-only">Equipment Category</label>
						                 <input type="text" id="equipmentCategory" class="form-control" placeholder="Equipment Category" name="equipmentCategory">	
										 </div>
										<div class="form-group">
										<label for="equipment" class="sr-only">
												Equipment Name
											</label>
						                 <input type="text" id="equipment" class="form-control" name="equipment" placeholder="Equipment Name">	
										 </div>
										 
										<div class="form-group">
										<label for="manufacturer" class="sr-only">
												Equipment Manufacturer
											</label>
						                 <input type="text" id="manufacturer" class="form-control" name="manufacturer" placeholder="Equipment Manufacturer">	
										 </div>
										 <div class="form-group">
										<label for="yearOfManufacturing" class="sr-only">
												Year Of Manufacturing
											</label>
						                 <input type="text" id="yearOfManufacturing" class="form-control" name="yearOfManufacturing" placeholder="Year of manufacturing">	
										 </div>
										 
										 <div class="form-group">
										<label for="model" class="sr-only">
												Model Details
											</label>
						                 <input type="text" id="model" class="form-control" name="model" placeholder="Model">	
										 </div>
										 <div class="form-group">
										<label for="capacity" class="sr-only">
												Capacity Details
											</label>
						                 <input type="text" id="capacity" class="form-control" name="capacity" placeholder="Capacity">	
										 </div>
										 <div id="hidden-fields">
						                                <input type="hidden" name="supplierId" id="supplierId" value="">
						                                <input type="hidden" name="supplierName" id="supplierName" value="">
						                                <input type="hidden" name="equipmentId" id="equipmentId" value="">
						                                </div>
										 <div class="form-group">
										<label for="quantity" class="sr-only">
												Equipment Quantity
											</label>
						                 <input type="text" id="quantity" class="form-control" name="quantity" placeholder="Equipment Quantity">	
										 </div>
								
										
										<div class="form-group">
											<div class="f1-buttons">
												<button type="button" id="update" class="btn btn-next modal-btn">update</button>
											</div>
										</div>
										<div class="clear-fix"></div>
									</form>
								</div>
							</div>
						</div>
					</div>
					
			<!-- ********************* This is for the delete model *********************************** -->
					<div class="modal fade" id="delete-equipment" role="dialog"
						aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content login-modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true">Ã—</button>
									<h4 class="modal-title" id="myModalLabel">Confirm</h4>
								</div>
								<div class="modal-body">
								<p>Are you sure you want to delete this equipment.</p>
								</div>
									<div class="modal-footer">
										<button type="button" id="yes" data-value="" data-loading-text="<i class='fa fa-cog fa-spin fa-3x fa-fw'></i>
				<span class='sr-only'>deleting...</span>" class="btn btn-next modal-btn">yes</button>
										<button type="button" id="no" class="btn btn-next modal-btn">No</button>
									</div>
			
						</div>
						</div>
					</div>		
					
					
			 <div class="modal fade" id="modal-success-dialog" role="dialog"
						aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal"
										aria-hidden="true">Ã—</button>
									<h4 class="modal-title" id="myModalLabel">Success</h4>
								</div>
								<div class="modal-body">
									<div class="alert alert-success" role="alert">Requirement posted successfully ...</div>
								</div>
							</div>
						</div>
					</div>
					
			<script type="text/javascript">
 			$(document).ready(function(){
 				
 				var userEquipments = [];
 				var user = $.getUser();
 				var username = user.firstname+" "+user.lastname;
 				$('#user').text(username);
 				$('#user-name').text(username);
 				
 				$.getAvatar(user);
 				
 				$('.logout').click(function(){
				        $.ajax({
		 					url:AppData.relativeUrl+"user/logout",
		 					type:"post",
		 					data:{},
		 					success:function(response){
		 						var user = localStorage.getItem("user");
						        if(user !== null){
						            localStorage.removeItem("user");
						        }
						        $(location).attr('href',"../index.html");
		 					}
		 					});
				        
				 });
 			
 			$('#view-machines').click(function(e){
 				$.getAllEquipments(user.userId,userEquipments);	
 			});	
 			
 			var categoryParam;
 	    	var sub_category;
			
 			$('#add-machines').click(function(e){
 	 	    	$(location).attr('href',"../addEquipment.html");
 			});
 			
 			
 	    	/* This function will be called when there is change in the category dropdown */
 	    	
 	    	$(".sidebar-content").on('change','#equipmentCategory',function(){
 	    		var selectedOption = $("#equipmentCategory option:selected").text();
 	    		var url = AppData.relativeUrl+"contractor/getEquipmentByCategory/"+selectedOption; 
 	    		$.ajax({
 	    			url:url,
 	    			type:"get",
 	    			data:{},
 	    			success:function(equipments){
 	    				equipments = $.parseJSON(equipments);
 	    				$("#equipment").html("");
 	    				$.each(equipments,function(index,value){
 	    				$("#equipment").append($("<option />").val(value).text(value));
 	    				});	
 	    			}
 	    				
 	    		});
 	    	});
 	    	
 			
 			
 			
 			$('.sidebar-content').on('click','#addEquipment',function(e){
 				var data = JSON.stringify($('#addEquipment-form').serializeObject());
 				$.ajax({
 	    			url:AppData.relativeUrl+"supplier/addequipment",
 	    			type:"post",
 	    			contentType:"application/json; charset=utf-8",
 	    			data:data,
 	    			success:function(response){
						if(response === "SS01"){
							$('#modal-success-dialog').modal('show').delay(5000);
						$('#modal-success-dialog').on('shown.bs.modal', function() {
							$.getAllEquipments(user.userId,userEquipments);
							$('#modal-success-dialog').modal('hide')
		    			});
						}
 	    			}
 	    				
 	    		});
 			});
 			
 			$.getAllEquipments(user.userId,userEquipments);	
 			
 			$('.sidebar-content').on('click','#edit',function(e){
 				var equipment = userEquipments[$(this).data("value")];
 				$('#equipmentCategory').val(equipment.equipmentCategory);
 				$('#equipment').val(equipment.equipment);
 				$('#manufacturer').val(equipment.manufacturer);
 				$('#model').val(equipment.model);
 				$('#yearOfManufacturing').val(equipment.yearOfManufacturing);
 				$('#capacity').val(equipment.capacity);
 				$('#quantity').val(equipment.quantity);
 				$('#supplierId').val(user.userId);
 				$('#supplierName').val(username);
 				$('#equipmentId').val(equipment.equipmentId);
 			});
 			
 			$('.sidebar-content').on('click','#delete',function(e){
 				$('#yes').data("value",$(this).data("value"));
 			});
 				
 				
 			$('#update').click(function(e){
				e.preventDefault();
					var formData = $("#equipment-form").serializeObject();
					var data = JSON.stringify(formData);
				 $.ajax({
						url : AppData.relativeUrl+"/supplier/updateequipment",
						type : "put",
						contentType : "application/json; charset=utf-8",
						data : data,
						success : function(response) {
							if(response === "ES01"){
								console.log("successfully udpated");
								$.getAllEquipments(user.userId,userEquipments);	
								/* $('#edit-profile').modal('hide'); */
								
							}else{
								console.log("exception while udpating");
							}
						}
						});
			});
			
				
			
			
			$('#no').click(function(){
				$('#delete-equipment').modal("hide");
			});
			
			$('#yes').click(function(){
				var $btn = $(this).button('loading');
				var equipmentId = $(this).data("value");
				$.ajax({
 	 				url:AppData.relativeUrl+"supplier/deleteEquipmentById/"+equipmentId,
 	 				type: "delete",
 	 				data:{},
 	 				success:function(response){
 	 					if (response.search("EE01") != -1) {
 	 						 console.log("Exception Occured while Adding Equipment");
 	 					}else{
 	 						 console.log("delete successfull");
 	 						 $.getAllEquipments(user.userId,userEquipments);
 	 					}	 
 	 					
 	 				}
 	 			});
				$btn.button('reset');
				//$('#delete-equipment').modal("hide");
			});
 				
 			});
 			</script>	
 			<script type="text/javascript">
 			
 			$.fn.serializeObject = function() {
 				var o = {};
 				var a = this.serializeArray();
 				$.each(a, function() {
 					if (o[this.name] !== undefined) {
 						if (!o[this.name].push) {
 							o[this.name] = [ o[this.name] ];
 						}
 						o[this.name].push(this.value || '');
 					} else {
 						o[this.name] = this.value || '';
 					}
 				});
 				return o;
 			};
 			
 			$.getAllEquipments = function(userId,userEquipments){
				$.ajax({
 	 				url:AppData.relativeUrl+"supplier/getallequipments/"+userId,
 	 				type: "get",
 	 				data:{},
 	 				success:function(response){
 	 					response = $.parseJSON(response);
 	 					var equipmentList = "";
 	 					var ul = '<ul class="nav-sidebar-content">';
 	 					$.each(response,function(index,value){
 	 						userEquipments[value.equipmentId] = value;
 	 						var createdTime = $.date(value.createdTime,1);
 	 						var catArr = [];
						     catArr = value.equipmentCategory.split(" ");
						     var category = "";
						     $.each(catArr,function(index,value){
						    	 if(index === catArr.length-1){
						    		 category += value;
						    	 }else{
						    	 category += value+"_";
						    	 }
						     });
						     var name = encodeURI(value.equipment);
 	 						
 	 						equipmentList += '<li><div class="media"><div class="media-left"><a href="#"><img src="../images/'+category+'/'+name+'.png" height="100px" width="100px"/></a></div>'+
 	 						'<div class="media-body"><div class="block-top"><h4>'+value.equipment+'</h4><div class="buttons"><a id="edit" role="button" data-toggle="modal" data-value='+value.equipmentId+' href="#edit-equipment">'+
 	 						'<i class="fa fa-edit"></i></a><a id="delete" role="button" data-toggle="modal" data-value='+value.equipmentId+' href="#delete-equipment"><i class="fa  fa-trash-o"></i></a></div>'+
 	 						'<div class="clear-fix"></div></div><p class="posted-date">Added on : '+createdTime+'</p><p>Quantity :'+value.quantity+' |  Capacity : '+value.capacity+'  |   Manufacturer : '+value.manufacturer+'  |   YOM : '+value.yearOfManufacturing+'</p>'+
 	 						'</div></div></li>';
 						});
 	 					$('.sidebar-content').html("");
 	 					$('.sidebar-content').append(ul+equipmentList+'</ul>');
 	 					
 	 				}
 	 			});
				
 			};
				
				$.date = function(dateObject,pattern) {
		 		    var d = new Date(dateObject);
		 		    var date = d.toDateString();
		 		    if(pattern === 1){
		 		    var dateArr = date.split(" ");
		 		    date = dateArr[2]+ "-" + dateArr[1] + "-" + dateArr[3];
		 		    }
		 		    else if(pattern === 2){
		 		    	var dateArr = dateObject.split(' ');
		 		    	var time = dateArr[3].split(':');
		 		    	var HH = parseInt(time[0])+6;
		 		    	var mm = parseInt(time[1])+30;
		 		    	var ss = time[2];
		 		    	if(dateArr[1].length === 3)
		 		    	date = dateArr[2]+ "-" + $.getMonth(dateArr[0])+ "-" +dateArr[1].substring(0,2)+"T "+HH+":"+mm+":"+ss+"Z";
		 		    	else if(dateArr[1].length === 2)
		 		    	date = dateArr[2]+ "-" + $.getMonth(dateArr[0])+ "-0" +dateArr[1].substring(0,1)+"T "+HH+":"+mm+":"+ss+"Z";	
		 		    }else if(pattern === 3){
		 	 		    var dateArr = dateObject.split("-");
		 	 		    date = dateArr[0]+ "-" + $.getMonthName(dateArr[1]) + "-" + dateArr[2];
		 				}
		 		    return date;
		 		};
		 		
		 		$.getMonthName = function(monNum){
		 			var month;
		 			if(monNum === "01"){
		 				month = "Jan";
		 			}
		 			else if(monNum === "02"){
		 				month = "Feb";
		 			}
		 			else if(monNum === "03"){
		 				month = "Mar";
		 			}
		 			else if(monNum === "04"){
		 				month = "Apr";
		 			}
		 			else if(monNum === "05"){
		 				month = "May";
		 			}
		 			else if(monNum === "06"){
		 				month = "Jun";
		 			}
		 			else if(monNum === "07"){
		 				month = "Jul";
		 			}
		 			else if(monNum === "08"){
		 				month = "Aug";
		 			}
		 			else if(monNum === "09"){
		 				month = "Sep";
		 			}
		 			else if(monNum === "10"){
		 				month = "Oct";
		 			}
		 			else if(monNum === "11"){
		 				month = "Nov";
		 			}
		 			else if(monNum === "12"){
		 				month = "Dec";
		 			}
		 			return month;
		 		};
		 		
		 		$.getMonth = function(month){
		 			var monNum;
		 			month = month.toLowerCase();
		 			if(month === "jan"){
		 				monNum = '01';
		 			}
		 			else if(month === "feb"){
		 				monNum = '02';
		 			}
		 			else if(month === "mar"){
		 				monNum = '03';
		 			}
		 			else if(month === "apr"){
		 				monNum = '04';
		 			}
		 			else if(month === "may"){
		 				monNum = '05';
		 			}
		 			else if(month === "june"){
		 				monNum = '06';
		 			}
		 			else if(month === "july"){
		 				monNum = '07';
		 			}
		 			else if(month === "aug"){
		 				monNum = '08';
		 			}
		 			else if(month === "sep"){
		 				monNum = '09';
		 			}
		 			else if(month === "oct"){
		 				monNum = '10';
		 			}
		 			else if(month === "nov"){
		 				monNum = '11';
		 			}
		 			else if(month === "dec"){
		 				monNum = '12';
		 			}
		 			
		 			return monNum;
		 		};	
				
			
 			</script>

</body>
</html>